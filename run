#!/usr/bin/env ruby
require 'cinch'

def action
  bot = Cinch::Bot.new do
    configure do |c|
      c.nick = '김젼봇'
      c.server = 'irc.ozinger.org'
      c.port = 6697
      c.channels = ['#test']
      c.max_reconnect_delay = 10
    end

    on :message, 'IP' do |m|
      m.reply `ifconfig eth1 | grep 'inet addr:' | cut -d: -f2 | awk '{ print $1 }'`
    end
  end

  bot.start
end

unless ARGV == ['production']
  action
else
  loop do
    begin
      action
    rescue Exception => msg
      puts ''
      puts ''
      puts '오직 죽음만이 나를 멈출 수 있다'
      puts ''
      puts msg
      puts ''
      puts ''
    end
  end
end
